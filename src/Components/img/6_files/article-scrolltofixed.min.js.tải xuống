(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{174:function(t,e,i){"use strict";i.r(e),i.d(e,"default",(function(){return O}));var o=i(3),s=i.n(o),n=i(9),r=i.n(n),a=i(1),c=i.n(a),f=i(8),l=i.n(f),u=i(6),h=i.n(u),d=i(2),m=i.n(d),p=i(15),g=i.n(p),v=i(16),x=i(96),y=i(4),L=i(30),$=i(0),b=i(14),w=i(37);function S(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=m()(t);if(e){var s=m()(this).constructor;i=Reflect.construct(o,arguments,s)}else i=o.apply(this,arguments);return h()(this,i)}}var O=function(t){l()(i,t);var e=S(i);function i(t){var o;return s()(this,i),o=e.call(this,t.app),g()(r()(o),"onLiveTabClick",(function(){setTimeout((function(){o.mostViewLimit=o.calcMostViewLimit(),o.recommendLimit=o.calcRecommendLimit()}),100)})),g()(r()(o),"updatePosition",(function(){var t=o.calcMostViewLimit(),e=o.calcCommentsLimit(),i=o.calcRecommendLimit();t&&t>o.mostViewLimit&&(o.mostViewLimit=t),e&&e>o.commentsLimit&&(o.commentsLimit=e),i>o.recommendLimit&&(o.recommendLimit=i)})),o.app=t.app,o.artUtils=t.artUtils,o.artInfo=t.artInfo,o.isLiveArticle=o.artInfo.isLiveArticle,o.init(),o.bindCommentEvents(),o.bindLiveEvents(),o}return c()(i,[{key:"name",get:function(){return"ScrollFixedArticle"}},{key:"recommendOffset",get:function(){return Object(y.c)(this.$recommend)}},{key:"$comments",get:function(){return this.artUtils.getArticleComments()}},{key:"$recommend",get:function(){return this.artUtils.getArticleRecommend()}},{key:"$articleNextRead",get:function(){return this.artUtils.getArticleNextRead()}},{key:"$mostview",get:function(){return this.artUtils.getMostViewArticles()}}]),c()(i,[{key:"init",value:function(){var t=this;this.$recommend&&(this.handleOnMostView(),this.handleOnNextRead(),setTimeout((function(){t.handleCommentLive(),t.handleOnRecommend()}),100))}},{key:"bindCommentEvents",value:function(){this.artInfo.articleLayout===$.d.REGULAR&&(this.app.on(b.a.VIEW_MORE_COMMENTS,this.updatePosition),this.app.on(b.a.RENDERED_COMMENTS,this.updatePosition))}},{key:"bindLiveEvents",value:function(){this.isLiveArticle&&this.app.on(b.a.LIVE_TAB_CLICK,this.onLiveTabClick)}},{key:"handleOnNextRead",value:function(){var t=this.$articleNextRead;if(t){var e=t.find(".scrollfixed");e&&Object(x.a)(e,{marginTop:70,offset:!0,unfixed:function(t){t.setStyles({top:0})}})}}},{key:"handleOnRecommend",value:function(){var t=this,e=this.$recommend;if(e&&this.Dom.hasClass(e,"has-sidebar")){var i=e.find(".banner");i&&(this.recommendLimit=this.calcRecommendLimit(),Object(x.a)(i,{marginTop:70,removeOffsets:!0,limit:function(){return t.isLiveArticle?t.calcRecommendLimit():t.recommendLimit},preAbsolute:function(t){t.addClass("noscroll")},postAbsolute:function(t){t.removeClass("noscroll")},fixed:function(t){t.addClass("fixedtop")},unfixed:function(t){t.removeClass("fixedtop"),t.setStyles({top:0})}}))}}},{key:"handleCommentLive",value:function(){var t=this,e=this.artInfo.articleLayout;if(this.artInfo.hasComments&&this.artInfo.isCommentLive&&e!==$.d.SPECICAL&&e!==$.d.NO_SIDEBAR){var i=this.$comments;i&&this.$recommend&&(this.commentsLimit=this.calcCommentsLimit(),Object(x.a)(i,{marginTop:70,removeOffsets:!0,limit:function(){return t.isLiveArticle?t.calcCommentsLimit():t.commentsLimit},preAbsolute:function(t){t.addClass("noscroll")},postAbsolute:function(t){t.removeClass("noscroll")}}))}}},{key:"handleOnMostView",value:function(){this.updateMostview()}},{key:"calcMostViewLimit",value:function(){var t=this.$mostview;return t?this.recommendOffset.top-t.offsetHeight-100:0}},{key:"calcRecommendLimit",value:function(){return this.recommendOffset.top+this.$recommend.offsetHeight-550}},{key:"calcCommentsLimit",value:function(){var t=this.$comments;return t?this.recommendOffset.top-t.offsetHeight:0}},{key:"updateMostview",value:function(){var t=this,e=this.artUtils.getArticleSidebar();if(e){var i,o=Object(L.a)(e).height(),s=0;e.findAll(':scope > *:not([style="display:none"]):not([id="mostview-articles"])').forEach((function(t){s+=Object(L.a)(t).height()})),i=o-s;var n=this.$mostview;if(n){var r=Object(L.a)(n);if(i<=r.height())r.hide();else{var a=function(){s>1500?r.setStyles({top:"1500px",bottom:"auto"}):r.setStyles({top:s+100+"px",bottom:"auto"})};a(),this.mostViewLimit=this.calcMostViewLimit(),Object(x.a)(r.$el,{marginTop:100,offset:!0,limit:function(){return t.updatePosition(),t.mostViewLimit},preAbsolute:function(t){t.addClass("noscroll")},postAbsolute:function(t){a(),t.removeClass("noscroll")},fixed:function(t){t.addClass("fixedtop")},unfixed:function(t){t.removeClass("fixedtop")}}),n.findAll(".article-thumbnail img[data-src]").forEach((function(t){Object(w.a)(t,{threshold:400,autoscale:!0})}))}}}}}]),i}(v.a)},96:function(t,e,i){"use strict";i.d(e,"a",(function(){return I}));var o=i(3),s=i.n(o),n=i(9),r=i.n(n),a=i(1),c=i.n(a),f=i(8),l=i.n(f),u=i(6),h=i.n(u),d=i(2),m=i.n(d),p=i(15),g=i.n(p),v=i(28),x=i(13),y=i(30),L=i(7);function $(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=m()(t);if(e){var s=m()(this).constructor;i=Reflect.construct(o,arguments,s)}else i=o.apply(this,arguments);return h()(this,i)}}var b="preFixed.".concat("ScrollToFixed"),w="postFixed.".concat("ScrollToFixed"),S="preUnfixed.".concat("ScrollToFixed"),O="postUnfixed.".concat("ScrollToFixed"),k="preAbsolute.".concat("ScrollToFixed"),C="postAbsolute.".concat("ScrollToFixed"),T="fixed.".concat("ScrollToFixed"),R="unfixed.".concat("ScrollToFixed"),A="resize.".concat("ScrollToFixed"),F="scroll.".concat("ScrollToFixed"),P="absolute",U="fixed",E=function(t){l()(i,t);var e=$(i);function i(t,o){var n;s()(this,i),n=e.call(this),g()(r()(n),"offsetTop",0),g()(r()(n),"offsetLeft",0),g()(r()(n),"originalOffsetLeft",-1),g()(r()(n),"lastOffsetLeft",-1),g()(r()(n),"spacerClass",""),g()(r()(n),"className",""),g()(r()(n),"checkScroll",(function(){if(n.isScrollToFixed){var t=n.isReset;if(t){if(n.isUnfixed()){var e=n.$target.offset(),i=e.top,o=e.left;n.offsetTop=i,n.offsetLeft=o}}else n.resetScroll();var s=Object(L.u)(),r=Object(L.v)(),a=n.getLimit(),c=n.options,f=c.minWidth,l=c.maxWidth,u=c.bottom,h=window.innerWidth,d=window.innerHeight,m=n.getMarginTop();f&&h<f||l&&h>l?n.isUnfixed()&&t||(n.postPosition(),n.trigger(S,n.$target),n.setUnfixed(),n.trigger(R,n.$target)):-1==u?a>0&&r>=a-m?n.isAbsolute()&&t||(n.postPosition(),n.trigger(k,n.$target),n.setAbsolute(),n.trigger(R,n.$target)):r>=n.offsetTop-m?(n.isFixed()&&t||(n.postPosition(),n.trigger(b,n.$target),n.setFixed(),n.lastOffsetLeft=-1,n.trigger(T,n.$target)),n.setLeft(s)):n.isUnfixed()&&t||(n.postPosition(),n.trigger(S,n.$target),n.setUnfixed(),n.trigger(R,n.$target)):a>0?r+d-n.$target.outerHeight>=a-(m||-n.getBottom())?n.isFixed()&&(n.postPosition(),n.trigger(S,n.$target),n.originalPosition===P?n.setAbsolute():n.setUnfixed(),n.trigger(R,n.$target)):(n.isFixed()||(n.postPosition(),n.trigger(b,n.$target),n.setFixed()),n.setLeft(s),n.trigger(T,n.$target)):n.setLeft(s)}})),g()(r()(n),"windowResize",(function(){n.$target.isVisible&&(n.isReset=!1,n.checkScroll())})),g()(r()(n),"windowScroll",(function(){window.requestAnimationFrame(n.checkScroll)})),n.options=Object(x.a)({},n.defaultOptions,o),n.$target=Object(y.a)(t),n.isReset=!1,n.$target.data("ScrollToFixed",1);var a=n.getOption("zIndex");n.$target.setStyles({zIndex:a}),n.$spacer=Object(y.a)(n.createDiv()),n.originalPosition=n.position,n.originalOffsetTop=n.getStyleProp("top"),n.isUnfixed()&&n.$target.insertAfter(n.$spacer.$el),n.registerEvents();var c=n.options.spacerClass;return c&&n.$spacer.addClass(c),n.windowResize(),n}return c()(i,[{key:"defaultOptions",get:function(){return{marginTop:0,limit:0,bottom:-1,zIndex:1e3,baseClassName:"scroll-to-fixed-fixed"}}},{key:"originalZIndex",get:function(){return this.getStyleProp("z-index")}},{key:"position",get:function(){return this.getStyleProp("position")}},{key:"isScrollToFixed",get:function(){return!!this.$target.data("ScrollToFixed")}}]),c()(i,[{key:"getStyleProp",value:function(t){return this.$target.getStyleValue(t)}},{key:"registerEvents",value:function(){window.on(A,this.windowResize),window.on(F,this.windowScroll),"ontouchmove"in window&&window.on("touchmove.".concat("ScrollToFixed"),this.checkScroll);var t=this.options,e=t.preFixed,i=t.postFixed,o=t.preUnfixed,s=t.fixed,n=t.unfixed,r=t.postUnfixed,a=t.preAbsolute,c=t.postAbsolute;e&&this.on(b,e),i&&this.on(w,i),o&&this.on(S,o),r&&this.on(O,r),a&&this.on(k,a),c&&this.on(C,c),s&&this.on(T,s),n&&this.on(R,n)}},{key:"getOption",value:function(t){return t?Object(x.b)(this.options,t):this.options}},{key:"createDiv",value:function(){return document.createElement("div")}},{key:"resetScroll",value:function(){this.trigger(S,this.$target),this.setUnfixed(),this.trigger(R,this.$target),this.lastOffsetLeft=-1;var t=this.$target.offset(),e=t.top,i=t.left;this.offsetTop=e,this.offsetLeft=i;var o=this.options,s=o.offsets,n=o.bottom;s&&(this.offsetLeft+=i),-1==this.originalOffsetLeft&&(this.originalOffsetLeft=this.offsetLeft),this.isReset=!0,-1!=n&&(this.trigger(b,this.$target),this.setFixed(),this.trigger(T,this.$target))}},{key:"getLimit",value:function(){var t=this.options.limit;return t?"function"==typeof t?t.apply(this.$target):t:0}},{key:"isFixed",value:function(){return this.position===U}},{key:"isAbsolute",value:function(){return this.position===P}},{key:"isUnfixed",value:function(){return!(this.isFixed()||this.isAbsolute())}},{key:"setFixed",value:function(){if(!this.isFixed()){this.$spacer.setStyles({display:this.getStyleProp("display"),width:this.$target.outerWidth+"px",height:this.$target.outerHeight+"px",float:this.getStyleProp("float")});var t=this.options,e=t.zIndex,i=t.bottom,o=t.dontSetWidth,s=t.className,n=t.baseClassName,r=-1==i,a={zIndex:e,position:U,top:r?this.getMarginTop()+"px":"",bottom:r?"":i+"px",marginLeft:"0px"};o||(a.width=this.$target.width()+"px"),this.$target.setStyles(a),this.$target.addClass(n),s&&this.$target.addClass(s)}}},{key:"setAbsolute",value:function(){var t=this.getLimit(),e=this.offsetLeft,i=this.options,o=i.removeOffsets,s=i.dontSetWidth;o&&(e="",t-=this.offsetTop);var n={position:P,top:t+"px",left:e+"px",marginLeft:"0px",bottom:""};s||(n.width=this.$target.width()+"px"),this.$target.setStyles(n)}},{key:"setUnfixed",value:function(){if(!this.isUnfixed()){this.lastOffsetLeft=-1,this.$spacer.hide(),this.$target.setStyles({zIndex:this.originalZIndex,width:"",position:this.originalPosition,left:"",top:this.originalOffsetTop+"px",marginLeft:""}),this.$target.removeClass(this.options.baseClassName);var t=this.options.className;t&&this.$target.removeClass(t)}}},{key:"setLeft",value:function(t){t!=this.lastOffsetLeft&&(this.$target.setStyles({left:"".concat(this.offsetLeft-t,"px")}),this.lastOffsetLeft=t)}},{key:"getMarginTop",value:function(){var t=this.options.marginTop;return t?"function"==typeof t?t.apply(this.$target):t:0}},{key:"getBottom",value:function(){var t=this.options.bottom;return void 0===t?0:t}},{key:"postPosition",value:function(){this.position==P?this.trigger(C,this.$target):this.position==U?this.trigger(w,this.$target):this.trigger(O,this.$target)}}]),i}(v.a);function I(t,e){return new E(t,e)}}}]);